generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String @id @default(cuid())
  username      String   @unique
  name          String
  email         String?  @unique
  role          String   @default("user")
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  password      String
  ordersCreated Order[]  @relation("OrderCreator")
}

model Order {
  id                String            @id @default(cuid())
  orderNumber       String            @unique
  kegiatan          String
  kegiatanLainnya   String?
  tanggalPermintaan DateTime
  tanggalPengiriman DateTime
  untukBagian       String
  yangMengajukan    String
  noHp              String
  namaApprover      String
  tipeTamu          String?
  keterangan        String?
  status            String            @default("Pending")
  tanggalPembatalan DateTime?
  createdBy         String
  createdAt         DateTime          @default(now())
  updatedAt         DateTime          @updatedAt
  items             ConsumptionItem[]
  user              User              @relation("OrderCreator", fields: [createdBy], references: [username])
}

model ConsumptionItem {
  id              String @id @default(cuid())
  jenisKonsumsi    String
  qty              Int
  satuan           String
  lokasiPengiriman String
  sesiWaktu        String
  waktu            String

  orderId          String     
  order            Order    @relation(fields: [orderId], references: [id], onDelete: Cascade)
}



model JenisKegiatan {
  id        String   @id  @default(cuid())
  nama      String   @unique
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Bagian {
  id        String   @id @default(cuid())
  nama      String   @unique
  kode      String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Approver {
  id        String   @id  @default(cuid())
  nama      String
  nip       String   @unique
  jabatan   String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Lokasi {
  id        String   @id @default(cuid())
  nama      String   @unique
  kategori  String?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model JenisKonsumsi {
  id            String   @id @default(cuid())
  nama          String   @unique
  kategori      String?
  satuanDefault String   @default("Porsi")
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model SesiWaktu {
  id        String   @id @default(cuid())
  nama      String   @unique
  urutan    Int?
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Menu {
  id          String   @id @default(cuid())
  nama        String
  sesiWaktu   String
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@unique([nama, sesiWaktu])
}
